# 1. Выбор темы
Аналог Instagram, направленный на российскую аудиторию. MVP - личный профиль, подписки, лента

# 2. Расчет нагрузки

## 2.1. Аудитория и ее активность

Аудитория Instagram в России на 2019 год согласно [источнику](https://popsters.ru/blog/post/svezhie-dannye-o-vk)  

Дневная аудитория - 26,9 % - 39,34 млн  
Месячная аудитория - 57,7% - 84,38 млн  

Приняв во внимание тот факт, что популярность сервиса сильно возросла к 2021 году [(источник)](https://popsters.ru/blog/post/socialnye-seti-v-mobayle-v-cifrah--issledovanie-appannie), то будем опираться на следующие показатели при проектировании  

Дневная аудитория - 30,0 % - 43,86 млн  
Месячная аудитория - 60,0% - 88 млн  

На 2021 год в среднем, пользователь тратит 29 минут в день [(источник)](https://www.emarketer.com/content/emarketer-reduces-us-time-spent-estimates-for-facebook-and-snapchat)  
## 2.2. Собственные наблюдения
За 3 минуты просмотра ленты было сделано 893 запроса, трафика на 41 мб (с учетом кеширования на клиенте)  

328 - картинки (19.6 мб)  
33 - статика (140 кб)  
598 - XHR из них ~ 60 POST (21.8 мб)   

За это время я успел просмотреть 30 постов, поставить 5 лайков и оставить один комментарий  

Будем предполагать, что средний пользователь добавляет 15 фотографий в свой профиль за месяц. Взаимодействует с подписками 10 раз в месяц  

## 2.3. Активность на пользователя

### Post:
```30 GET / 3 min``` Количество лайков, комментариев и сами первые три комментарии приходят вместе с запросом  
```15 POST / month``` Запрос на один пост занимает примерно 200кб (картинка) + 5 кб (другая информация)  

### Profile:
```1 GET / 3min``` Вместе с запросом на профиль приходит информация о подписках.  

Запрос на профиль занимает 40кб + первые посты ~740кб  

### Comment:
```
1 POST / 3 min.
```

Средняя длина комментариев в социальных сетях 200 символов (200b) [(источник)](https://habr.com/ru/post/72185/)  

### Subscriptions:
```
10 POST / month
1 GET / 3 min
```

### Likes:
5 POST / 3 min

## 2.3. Нагрузка от всей аудитории
Подитожим за сутки, учитывая, что пользователь тратит в сутки в среднем 29 мин:  

Учтем, что основная активность аудитории в Instagram приходится с 7:00 до 23:00  

Пусть ```k = 50 000 000 users / (17 * 60 * 60) = 817 u/s``` - коэффициент, переводящий показатель requests per day для одного человека в rps для всей аудитории. 

### Получение картинок:
```
328 * (29 min / 3 min) * k= 3170 requests / day * k = 2 589 890 rps
19.6 Mb * (29 min / 3 min) * k = 189,47 Mb / day * k = 151,17 Gb/s
```

### Статика:
Пользователь в среднем заходит в 15 раз в месяц [(источник)](https://popsters.ru/blog/post/svezhie-dannye-o-vk). С учетом того, что статика кешируется на клиенте получим
```
33 * 15 days / 30 days * k= 16,5 requests / day * k = 13 481 rps
140 Kb * 15 days / 30 days * k = 70 Kb / day * k = 56,47 Mb/s
```
### XHR:
```
598 * (29 min / 3 min) * k = 5780,67 requests/day * k = 4 722 807 rps
21,8 Mb * (29 min / 3 min) * k = 210,73 Mb/day * k = 168,13 Gb/s
```

## Рассмотрим по отдельности:
### Post
	GET: 30 * (29 min / 3 min) * k = 290 requests/day * k = 236 930 rps  (46,31 Gb/s)
	POST: 15 / 30 days * k = 0,5 requests/day * k = 409 rps (81,38 Mb/s)
### Profile
	GET: 1 * (29 min / 3 min) * k = 9,67 requests/day * k = 7 900 rps (74,58 Mb/s)

Согласно [источнику](https://popsters.ru/blog/post/auditoriya-socsetey-v-rossii) в 2019 году ежемесячный охват инстаграмма в России - 30,7 млн пользователей, следовательно прирост 28.7 млн  

Согласно [источнику](https://ppc.world/articles/auditoriya-shesti-krupneyshih-socsetey-v-rossii-v-2020-godu-izuchaem-insayty/) в 2020 году ежемесячный охват инстаграмма в России - 59,4 млн  

Это значит, прирост пользователей в день ```28.7 million / 365 = 78630,14 users/day```  

Тогда rps на регистрацию будет ~ 2 rps  

### Comments:
```
GET 30 post * 3 comments * 29 min / 3 min * k = 735 300 rps (147 Mb/s)
POST 1 * 29 min / 3 min * k = 7 897,67 rps (2 Mb/s)
```

### Likes:
```
GET 30 post * 29 min / 3 min * k = 236 930 rps
POST 5 * 29 min / 3 min * k = 39 489 rps
```
